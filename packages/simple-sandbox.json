{"name":"simple-sandbox","version":"0.3.5","description":"A simple sandbox for Node.js using Linux namespaces and cgroup.","main":"lib/index.js","types":"lib/index.d.ts","gypfile":true,"license":"MIT","repository":"https://github.com/t123yh/simple-sandbox","keywords":["sandbox","chroot","linux"],"dependencies":{"bindings":"^1.2.1","nan":"^2.6.2","randomstring":"^1.1.5"},"devDependencies":{"@types/node":"^8.0.9","node-gyp":"^3.6.1","typescript":"^2.3.2"},"scripts":{"build":"tsc -p ./src","build:watch":"tsc -w -p ./src","install":"node-gyp rebuild"},"optionalDependencies":{},"gitHead":"cdd466e654685a3d873e920afa2b053048b0eb21","homepage":"https://github.com/t123yh/simple-sandbox#readme","readme":"# simple-sandbox\nA simple linux sandbox with Node.js API.\n\n## Prerequisites\n### Packages\nYou need to have the build-essentials (g++, make, etc.) and the boost library (particularly, boost-system and boost-filesystem) installed in your system in order to build the C++ part.\n\nInstall them by (in Ubuntu):\n```bash\napt install build-essential libboost-all-dev\n```\n### Kernel\nYou need to have the memory swap account (disabled by default in Debian 8) enabled with your kernel. You can verify this by checking the existence of `/sys/fs/cgroup/memory/memory.memsw.usage_in_bytes` \n\nIf that file does not exist, then you may have to turn on that with your grub.\n\nAdd `swapaccount=1` to `GRUB_CMDLINE_LINUX_DEFAULT` section in `/etc/default/grub`.\n```bash\nGRUB_CMDLINE_LINUX_DEFAULT=\"quiet splash cgroup_enable=memory swapaccount=1\"\n```\n\nAnd then run\n```bash\nupdate-grub && reboot\n```\nTo enjoy the modified kernel.\n\n## Build\nPull the repository to somewhere on your computer and run\n```bash\nyarn install # Install required packages and compile C++ code.\nyarn run build # Compile typescript code.\n```\nTo build the project. If you don't want to use `yarn`, just change `yarn` to `npm`.\n\nYou can use `yarn run build:watch` to watch for the change of typescript file.\n\n## Use\nThe library is with a simple API.\nTo start the sandbox, use the following code:\n```js\nconst sandbox = require('simple-sandbox');\nconst myProcess = await sandbox.startSandbox(parameters);\n```\nwhere `parameters` is an instance of the [SandboxParameters interface](src/interfaces.ts). The detail explanation is available in the comments in that file.\n\nThe startSandbox function returns a Promise, from which you can get an instance of the [sandboxProcess](src/sandboxProcess.ts) class, reprensenting your sandboxed Process.\n\nTo terminate the sandboxed process, just use the `stop()` function:\n```js\nmyProcess.stop();\n```\n\nTo wait for the sandboxed process to end, use the `waitForStop()` function, which returns a `Promise`:\n```js\nmyProcess.waitForStop().then((result) => {\n    console.log(\"OK! \" + JSON.stringify(result));\n}).catch((err) => {\n    console.log(\"Whooops!\" + err.toString());\n});\n```\n\nNote that `myProcess` itself is a EventEmitter, so you can register `exit` (indicates that the child process exited), and `error` (indicates that some error happens) event listener on it.\n\n### Note\nWhen a sandbox is started, a event listener for the `exit` event on the `process` object is registered. When Node.js is about to exit, it will kill the sandboxed process.\n\nHowever, the `exit` event won't be called if there are `SIGTERM` or `SIGINT` (Ctrl-C) signals sent to the Node.js process. You should let the `SIGTERM` and `SIGINT` handler to call `process.exit()` on the main process:\n\n```js\nconst terminationHandler = () => {\n    process.exit(1);\n};\n\nprocess.on('SIGTERM', terminationHandler);\nprocess.on('SIGINT', terminationHandler);\n```\n\n## Example\nA demostration is available in the `demo` directory.\nIn order to get the demostration running for every one, we create the directory `/opt/sandbox-test`.\n\n```bash\nsudo mkdir /opt/sandbox-test\nsudo chown $(whoami) /opt/sandbox-test\nmkdir /opt/sandbox-test/rootfs /opt/sandbox-test/binary /opt/sandbox-test/working\ncurl -L https://nl.alpinelinux.org/alpine/v3.5/releases/x86_64/alpine-minirootfs-3.5.2-x86_64.tar.gz | tar -xzvf - -C /opt/sandbox-test/rootfs\n```\n\n**(to be continued)**","versions":[{"number":"0.0.1","date":"2017-05-01T14:56:39.511Z"},{"number":"0.0.2","date":"2017-05-01T15:04:36.278Z"},{"number":"0.0.3","date":"2017-05-01T15:13:29.299Z"},{"number":"0.0.4","date":"2017-05-02T05:05:39.025Z"},{"number":"0.0.5","date":"2017-05-02T05:08:21.268Z"},{"number":"0.0.6","date":"2017-06-07T15:08:58.941Z"},{"number":"0.0.8","date":"2017-06-09T14:35:08.367Z"},{"number":"0.0.10","date":"2017-06-17T14:56:19.277Z"},{"number":"0.0.11","date":"2017-06-21T14:55:42.297Z"},{"number":"0.0.12","date":"2017-06-21T15:15:19.353Z"},{"number":"0.0.13","date":"2017-06-22T14:14:14.564Z"},{"number":"0.0.14","date":"2017-06-24T04:08:08.480Z"},{"number":"0.0.15","date":"2017-06-24T15:57:50.004Z"},{"number":"0.0.16","date":"2017-06-25T03:04:15.572Z"},{"number":"0.1.0","date":"2017-07-01T08:45:53.497Z"},{"number":"0.1.1","date":"2017-07-01T08:48:35.819Z"},{"number":"0.1.2","date":"2017-07-01T11:21:25.616Z"},{"number":"0.1.3","date":"2017-07-01T12:12:47.710Z"},{"number":"0.1.4","date":"2017-07-02T10:30:33.674Z"},{"number":"0.2.0","date":"2017-07-08T07:09:27.624Z"},{"number":"0.2.1","date":"2017-07-08T11:44:53.890Z"},{"number":"0.2.2","date":"2017-07-08T12:06:24.247Z"},{"number":"0.2.3","date":"2017-07-08T18:19:34.950Z"},{"number":"0.2.4","date":"2017-07-08T23:24:59.362Z"},{"number":"0.2.5","date":"2017-07-09T16:03:08.558Z"},{"number":"0.3.0","date":"2017-07-15T15:02:44.047Z"},{"number":"0.3.1","date":"2017-07-16T16:52:33.868Z"},{"number":"0.3.2","date":"2017-07-26T14:05:37.797Z"},{"number":"0.3.3","date":"2017-07-29T12:53:13.487Z"},{"number":"0.2.6","date":"2017-08-21T10:31:38.686Z"},{"number":"0.3.4","date":"2017-08-21T10:32:48.884Z"},{"number":"0.3.5","date":"2017-08-26T14:01:05.464Z"}],"created":"2017-05-01T14:56:39.511Z","modified":"2017-08-26T14:01:05.464Z","lastPublisher":{"name":"t123yh","email":"t123yh@outlook.com"},"owners":[{"name":"t123yh","email":"t123yh@outlook.com"}],"other":{"_attachments":{},"_id":"simple-sandbox","_nodeVersion":"8.4.0","_npmOperationalInternal":{"host":"s3://npm-registry-packages","tmp":"tmp/simple-sandbox-0.3.5.tgz_1503756064221_0.918781905202195"},"_npmUser":{"name":"t123yh","email":"t123yh@outlook.com"},"_npmVersion":"5.3.0","_rev":"36-a4178c5ead60288612b168f13d94568e","author":{"name":"t123yh"},"bugs":{"url":"https://github.com/t123yh/simple-sandbox/issues"},"directories":{},"dist-tags":{"latest":"0.3.5"},"dist":{"integrity":"sha512-uLJc+xoF/o7zKeya9f6n0B6gY+h6N0QgbfIEBw/y90gDd0+rqavH9OZnqMPwWvMKKKQsRG+SLEL8/iJ3uU7p4Q==","shasum":"7d61845a190145887de59c969de27f64a74ef9a7","tarball":"https://registry.npmjs.org/simple-sandbox/-/simple-sandbox-0.3.5.tgz"},"maintainers":[{"name":"t123yh","email":"t123yh@outlook.com"}],"readmeFilename":"README.md","time":{"modified":"2017-08-26T14:01:05.464Z","created":"2017-05-01T14:56:39.511Z","0.0.1":"2017-05-01T14:56:39.511Z","0.0.2":"2017-05-01T15:04:36.278Z","0.0.3":"2017-05-01T15:13:29.299Z","0.0.4":"2017-05-02T05:05:39.025Z","0.0.5":"2017-05-02T05:08:21.268Z","0.0.6":"2017-06-07T15:08:58.941Z","0.0.8":"2017-06-09T14:35:08.367Z","0.0.10":"2017-06-17T14:56:19.277Z","0.0.11":"2017-06-21T14:55:42.297Z","0.0.12":"2017-06-21T15:15:19.353Z","0.0.13":"2017-06-22T14:14:14.564Z","0.0.14":"2017-06-24T04:08:08.480Z","0.0.15":"2017-06-24T15:57:50.004Z","0.0.16":"2017-06-25T03:04:15.572Z","0.1.0":"2017-07-01T08:45:53.497Z","0.1.1":"2017-07-01T08:48:35.819Z","0.1.2":"2017-07-01T11:21:25.616Z","0.1.3":"2017-07-01T12:12:47.710Z","0.1.4":"2017-07-02T10:30:33.674Z","0.2.0":"2017-07-08T07:09:27.624Z","0.2.1":"2017-07-08T11:44:53.890Z","0.2.2":"2017-07-08T12:06:24.247Z","0.2.3":"2017-07-08T18:19:34.950Z","0.2.4":"2017-07-08T23:24:59.362Z","0.2.5":"2017-07-09T16:03:08.558Z","0.3.0":"2017-07-15T15:02:44.047Z","0.3.1":"2017-07-16T16:52:33.868Z","0.3.2":"2017-07-26T14:05:37.797Z","0.3.3":"2017-07-29T12:53:13.487Z","0.2.6":"2017-08-21T10:31:38.686Z","0.3.4":"2017-08-21T10:32:48.884Z","0.3.5":"2017-08-26T14:01:05.464Z"}}}
{"name":"shmdb","version":"0.3.0","keywords":["share memory","shmdb","multi-process"],"description":"A key/value embedded database  aimed at resolving the problem of sharing memory among multi-process.","scripts":{"install":"node-gyp rebuild"},"repository":"https://github.com/yunnysunny/node-shmdb","dependencies":{"nan":"^2.5.0"},"homepage":"https://github.com/yunnysunny/node-shmdb","main":"index.js","gitHead":"ab024f49b1ecbd59c20d49770523a532773bdbdd","gypfile":true,"versions":[{"number":"0.1.0","date":"2014-11-15T14:03:44.736Z"},{"number":"0.1.1","date":"2014-11-15T14:11:32.855Z"},{"number":"0.1.2","date":"2014-11-29T11:58:43.617Z"},{"number":"0.1.3","date":"2015-01-05T05:19:31.419Z"},{"number":"0.2.0","date":"2015-05-26T09:26:02.741Z"},{"number":"0.3.0","date":"2017-01-09T08:51:50.874Z"}],"readme":"# node-shmdb\r\n\r\n## why\r\nShareing the data between parent process and child process,you can servel ways.\r\nFirst,use variable.\r\n\r\n\tvar cluster = require('cluster'); \r\n\tvar a = 1;\r\n\tif (cluster.isMaster) {\t\r\n\t\tcluster.fork();  \r\n\t} else if (cluster.isWorker) {\r\n\t\tconsole.log('a is ',a);\r\n\t}\r\nVarivale `a` will get the value `1` in child process.But when you assign the value of `a` in one of process, the other process can not get the new value.In other words, it suit for readonly varivale.\r\n\r\nSecond,using event message to notify the other process.\r\n\r\n\tvar cluster = require('cluster'); \r\n\r\n\tif (cluster.isMaster) {\t\r\n\t\tvar worker = cluster.fork();  \r\n\t\tworker.send('a message form parent');\r\n\t\tworker.on('message', function(msg) {//message send by child\r\n\t\t\tconsole.log('get a message,its value:',msg);\r\n\t\t});\r\n\t} else if (cluster.isWorker) {\r\n\t\tcluster.worker.send(1);\r\n\t\tprocess.on('message',function(msg) {\r\n\t\t\tconsole.log(msg);\r\n\t\t});\r\n\t}  \r\nIn node,you can use the method of send to notify other process some value has changed.It suit for one process write and the other read.\r\nBut while both of two process read and read the same data,how can we deal with it? As we all known,there is no mechanism of lock in node,how to pervent from reading dirty data? `node-shmdb` is just aim at resolving the issue.\r\n\r\n## theory\r\n`node-shmdb` is an implementation of [shmdb](https://github.com/yunnysunny/shmdb \"shmdb project\"), which is based on os's shared memory.`shmdb` is a key-value type of database, unlike memcache or redis, it is not a database that connected via network,but it is embeded.For sharing data between processes, it use operation system's shared memeory.\r\n\r\n## install\r\n\r\n`npm install shmdb`\r\n\r\n## example\r\n\r\n\tvar shmdb = require('shmdb');\r\n\tvar cluster = require('cluster');\r\n\tvar obj = null;\r\n\t\r\n\tif (cluster.isMaster) {\r\n\t\tconsole.info('=====================I am master=====================');\r\n\t\tobj = shmdb(10);\r\n\t\tif (obj.rv == 0) {\r\n\t\t\tconsole.log(obj);\r\n\t\t\tobj.put('some','value1');\r\n\t\t\t\r\n\t\t\tcluster.fork({shmid:obj.shmid,semid:obj.semid});  \r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tconsole.log('get new value changed in child process.',obj.get('some'));\r\n\t\t\t\tconsole.log('put value to xx in parent process.',obj.put('xx','parent'));\r\n\t\t\t},2000);\r\n\t\t} else {\r\n\t\t\tconsole.error('get shared memery error:0x[%x]',obj.rv);\r\n\t\t}\r\n\t\t\r\n\t} else if (cluster.isWorker) {\r\n\t\tconsole.info('=====================I am child=====================');\r\n\t\tvar shmid = parseInt(process.env.shmid);\r\n\t\tvar semid = parseInt(process.env.semid);\r\n\t\tif (shmid && semid) {\r\n\t\t\tobj = shmdb({shmid:shmid,semid:semid});\r\n\t\t\tconsole.log('get some in child:',obj.get('some'));\r\n\t\t\tconsole.log('put result in child',obj.put('some','other'));\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tconsole.log('get xx form parent',obj.get('xx'));\r\n\t\t\t},4000); \r\n\t\t}\r\n\t}\r\n\r\n## API\r\n\r\n### shmdb(param)\r\n\r\n**description**  \r\nInitializing shmdb in parent process or child process.It return an instance of Class `Shmdb`.\r\n\r\n**parameter**\r\n\r\n- {Number|Object} `param`  Using `Number` in parent process,it will create the shared memery in operation system,and return the two variableï¼Œ`shmid` and `semid`,which will be used in child process.Using `Object` in child process,and its format should be `{shmid:Number,semid:Number}`,the `shmid` and `semid` can be \r\nobtained from parent process.\r\n\r\n**return**\r\n\r\n- {Shmdb} its prototies are as follows:\r\n\r\n\t\t{rv:Number,shmid:Number,semid:Number}\r\n\t\r\n\tWhen success,the `rv` will be zero,and `shmid` and `semid` will be assigned.On the other hand,the `rv` will be none-zero.\r\n\r\n### Shmdb.prototype.put(key,value)\r\n\r\n**description**\r\n\r\nPut a pair of key/value into shmdb.\r\n\r\n**parameter**\r\n\r\n- key {String} the key\r\n- value {String} the value\r\n\r\n**return**\r\n\r\n- {Object} {code:Number} when success the `code` will be zero.\r\n\r\n### Shmdb.prototype.get(key)\r\n\r\n**decription**\r\n\r\nGet value by key.\r\n\r\n**parameter**\r\n\r\n- key {String} the key\r\n\r\n**return**\r\n\r\n- {Object} {code:Number,value:String}  when success the `code` will be zero.\r\n\r\n### Shmdb.prototype.remove(key)\r\n\r\n**description**\r\n\r\nRemove an pair of key/value by key.\r\n\r\n**parameter**\r\n\r\n- key {String} the key\r\n\r\n**return**\r\n\r\n{Object} {code:Number,value:String}  when success the `code` will be zero.\r\n\r\n### Shmdb.prototype.destroy()\r\n\r\n**description**\r\n\r\nDestory the shared memery allocated when you call the function `shmdb`.When process exit,this function will be called auto.\r\n\r\n**parameter**\r\n\r\n- void\r\n\r\n**return**\r\n\r\n- {Object} {code:Number} when success the `code` will be zero.\r\n\r\n## contributors\r\n[yunnysunny](https://github.com/yunnysunny) (maintainer)\r\n\r\n## license\r\n[Apache License, Version 2.0](http://www.apache.org/licenses/LICENSE-2.0.html)\r\n","created":"2014-11-15T14:03:39.431Z","modified":"2017-01-09T08:51:50.874Z","lastPublisher":{"name":"yunnysunny","email":"yunnysunny@gmail.com"},"owners":[{"name":"yunnysunny","email":"yunnysunny@gmail.com"}],"other":{"_attachments":{},"_from":".","_id":"shmdb","_nodeVersion":"6.9.2","_npmOperationalInternal":{"host":"packages-18-east.internal.npmjs.com","tmp":"tmp/shmdb-0.3.0.tgz_1483951908496_0.5598899875767529"},"_npmUser":{"name":"yunnysunny","email":"yunnysunny@gmail.com"},"_npmVersion":"3.10.9","_rev":"2-c168706bfe4cc689eda531fa3d431329","_shasum":"b93f79d3b816bcd84deacc4ebad32e4b230c53d9","author":{"name":"yunnysunny","email":"yunnysunny@gmail.com"},"bugs":{"url":"https://github.com/yunnysunny/node-shmdb/issues"},"contributors":[{"name":"yunnysunny","email":"yunnysunny@gmail.com"}],"directories":{},"dist-tags":{"latest":"0.3.0"},"dist":{"shasum":"b93f79d3b816bcd84deacc4ebad32e4b230c53d9","tarball":"http://registry.npmjs.org/shmdb/-/shmdb-0.3.0.tgz"},"maintainers":[{"name":"yunnysunny","email":"yunnysunny@gmail.com"}],"readmeFilename":"readme.md","time":{"modified":"2017-01-09T08:51:50.874Z","created":"2014-11-15T14:03:39.431Z","0.1.0":"2014-11-15T14:03:44.736Z","0.1.1":"2014-11-15T14:11:32.855Z","0.1.2":"2014-11-29T11:58:43.617Z","0.1.3":"2015-01-05T05:19:31.419Z","0.2.0":"2015-05-26T09:26:02.741Z","0.3.0":"2017-01-09T08:51:50.874Z"}}}